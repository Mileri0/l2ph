                  L2PacketHack 3.4.1 by CODERX.RU TEAM
                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                     Что нового в последней версии
                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

[!] Важное замечание
[+] Нововведение
[-] Исправлена ошибка
[*] Изменения

Revision: 76
Author: nlobp
Date: 01:05:00, 07 января 2009 г.
Message:
[*] Выводим в лог о сохранении лога пакетов, для большей информативности;
[*] Продублировал чекбокс isGraciaOff переменной isGraciaOf;
[+] Ищем скрытые процессы by MS-Rem;
[-] Исправлена ошибка - переименованная inject.dll не инжектилась в клиент;
[-] Исправлена ошибка функции Loop в PacketsT1.ini;
[+] запрещаем загружать два раза программу:

Revision: 75
Author: nlobp
Date: 01:45:00, 03 января 2009 г.
Message:
[*] На вкладке "Основное" галочка Gracia(off server) и isGraciaOff в Options.ini включает обход ShieldConsole;

Revision: 74
Author: nlobp
Date: 00:05:00, 02 января 2009 г.
Message:
[-] Исходник почему-то лежал в plugins\Coding.pas (мешало компиляции);
[*] Мелкие исправления заголовков групбоксов;

Revision: 73
Author: nlobp
Date: 03:33:00, 31 декабря 2008 г.
Message:
[*] Поднял иконки вверх на вкладке "Просмотр";
[*] Добавил парочку групбоксов для однообразия;

Revision: 72
Author: nlobp
Date: 17:50:00, 28 декабря 2008 г.
Message:
[+] AllowExit в Options.ini разрешает выход без запроса;
[+] ShitConsole в Options.ini включает обход ShieldConsole;

Revision: 71
Author: nlobp
Date: 17:15:00, 28 декабря 2008 г.
Message:
[*] sysmsgid.ini, itemsid.ini, skillsid.ini, npcsid.ini из l2.ru, спасибо Xelat;
[+] Добавлен вывод даты и времени в лог;
[*] расшифровка пакета sD0=MultiSellList (не полная);

Revision: 70
Author: xkor
Date: 22:00:00, 23 декабря 2008 г.
Message:
[+] к программе можно подключаться как к socks5 прокси серверу (при установке соответствующей галочки);

Revision: 69
Author: nlobp
Date: 16:30:00, 21 декабря 2008 г.
Message:
[*] подготовил и заюзал systemmsg.ini, itemname.ini, systemmsg.ini, npcname.ini от l2.ru;
[-] исправил ошибку показа имя NPC в расшифровке пакетов;
[-] исправил ошибку посылки скрипта на вкладку "Дополнительно";
[+] Ограничение максимального количества строк в логе пакетов, после чего скидываем в файл и очищаем лог. Настраивается в options.ini переменной MaxLinesInPktLog (по умолчанию 3000 пакетов);

Revision: 68
Author: nlobp
Date: 01:50:00, 10 декабря 2008 г.
Message:
[-] фикс ошибки List index of bounds в поиск/замена;

Revision: 67
Author: nlobp
Date: 01:10:00, 10 декабря 2008 г.
Message:
[-] фикс ошибки 39 пакета в Камаель-Грация;
[*] очищаем поля при смене подключения в списке соединений;

Revision: 66
Author: nlobp
Date: 02:40:00, 08 декабря 2008 г.
Message:
[+] Ограничение максимального количества строк в логе, после чего скидываем в файл и очищаем лог. Настраивается в options.ini переменной MaxLinesInLog (по умолчанию 300 строк);

Revision: 65
Author: nlobp
Date: 03:05:00, 06 декабря 2008 г.
Message:
[+] добавил кнопку для показа смещения в Hex/Dec с сохранением в options.ini;
[*] Небольшие поправки...

Revision: 64
Author: nlobp
Date: 03:30:00, 29 ноября 2008 г.
Message:
[*] в расшифровке пакетов, смещение значений теперь десятичные;
[!] Для писателей плугинов: к смещению значения надо прибавлять единицу

Revision: 63
Author: xkor
Date: 22:46:30, 26 ноября 2008 г.
Message:
[*] Небольшие поправки...

Revision: 62
Author: nlobp
Date: 12:33:05, 19 ноября 2008 г.
Message:
[-] Исправил работу кнопки "убирает все пакеты текущего типа из списка пакетов"

Revision: 61
Author: xkor
Date: 21:30:00, 6 ноября 2008 г.
Message:
[+] поддержка дополнительного шифрования id пакетов в Gracia на оффициальных серверах, спасибо ShadeOfNothing

Revision: 60
Author: nlobp
Date: 0:53:00, 26 октября 2008 г.
Message:
[*] изменил реагирование на ошибку выхода за границу пакета, пишем в расшифровку пакета 'range error'
[*] на вкладке "просмотр" и "посылка" добавил показ места, где расположены данные, по клику мыши и нажатию клавиш (стрелок) вверх/вниз.

Revision: 59
Author: nlobp
Date: 1:43:00, 24 октября 2008 г.
Message:
[*] правил потоки

Revision: 58
Author: nlobp
Date: 1:41:38, 24 октября 2008 г.
Message:
[*] правка потоков

Revision: 57
Author: nlobp
Date: 1:31:38, 22 октября 2008 г.
Message:
[*] правка потоков, надеюсь последняя
[*] добавил сплиттер в закладке "посылка"
[*] устранение утечек памяти

Revision: 55
Author: wanick
Date: 21:07:23, 21 октября 2008 г.
Message:
[*] исправил просмотр пакетов

Revision: 54
Author: nlobp
Date: 2:32:04, 21 октября 2008 г.
Message:
[*] правка завершения ServerListen потока, спасибо Sauron
[*] вернул кнопку "Добавить пакет в посылку"
[!] wanick испортил (build 50) смену packets.ini, надо искать где

Revision: 53
Author: nlobp
Date: 0:58:14, 20 октября 2008 г.
Message:
[*] правка потоков

Revision: 52
Author: nlobp
Date: 2:04:51, 18 октября 2008 г.
Message:
[*] правка потоков

Revision: 51
Author: wanick
Date: 3:18:44, 17 октября 2008 г.
Message:
[*] начал вынос вспомогательных методов в отдельный pas
[*] скрыл кнопку добавить в отправку на вкладке просмотра пакетов,
    вопрос нужна ли эта кнопка вообще если нужна кто-нибудь включите

Revision: 50
Author: wanick
Date: 0:13:14, 17 октября 2008 г.
Message:
[*] дорабатывал обработку работы с пакетами, не понравилось как было :)

Ревизия: 48
Автор: xkor
Дата: 00:50:00, 15 октября 2008 г.
[+] В контекстном меню иконки программы появились подменю "Скрипты" и "Плагины" в которых можно включить/выключить их не открывая окно программы;
[*] FastMM4 настроен так чтобы плагины и программа были совместимы не зависимо от режима компиляции;

Ревизия: 47
Автор: xkor
Дата: 15:50:00, 13 октября 2008 г.
[*] исправлен вход в бесконечный цикл при неудачном подключении к серверу, теперь при неудачных конектах не будут плодиться потоки, спасибо Argot;

Ревизия: 46
Автор: xkor
Дата: 19:10:00, 12 октября 2008 г.
[+] Из плагинов теперь можно добавлять в скрипты свои функции, для этого в плагине должны быть две функции: OnCallMethod и OnRefreshPrecompile;
[!] Внимание! Для корректной работы плагинов они должны быть скомпилированны в том же режиме что и L2PacketHack, тоесть если пакетхак скомпилирован с директивой Relise, то и плагины должны быть скомпилированными с ней же, в противном случае возможны конфликты в модуле FastMM4;

Ревизия: 45
Автор: xkor
Дата: 23:45:00, 10 октября 2008 г.
[*] Исправлена обработка результата SetStruct в плагинах;

Ревизия: 44
Автор: xkor
Дата: 21:00:00, 10 октября 2008 г.
[+] Добавлен вывод подробной информации об ошибках в случае их возникновения;
[*] Релиз поддержки плагинов, теперь всё работает как планировалось, подробности в описании;

Ревизия: 40
Автор: nlobp
Дата: 3:06:00, 7 октября 2008 г.
[*] при вызове окна поиск/замена наводим фокус на поле ввода;
[*] при переходе на вкладку "скрипты" наводим фокус на поле редактора;
[*] опять копался в потоках;

Ревизия: 39
Автор: xkor
Дата: 0:01:00, 7 октября 2008 г.
[+] обновил возможности плагинов, теперь из плагина есть доступ к следующим
    встроенным в пакетхак фукнциям:
    procedure SendPacket(Size: Word; pck: string; tid: Byte; ToServer: Boolean);
    procedure SendPckStr(pck: string; const tid: Byte; const ToServer: Boolean);
    procedure SendPckData(var pck; const tid: Byte; const ToServer: Boolean); stdcall;
    function DataPckToStrPck(var pck): string; stdcall;

    function ReadC(const pck: string; const index:integer):byte; stdcall;
    function ReadH(const pck: string; const index:integer):word; stdcall;
    function ReadD(const pck: string; const index:integer):integer; stdcall;
    function ReadF(const pck: string; const index:integer):double; stdcall;
    function ReadS(const pck: string; const index:integer):string; stdcall;
    function ReadCEx(const pck; const index:integer):byte; stdcall;
    function ReadHEx(const pck; const index:integer):word; stdcall;
    function ReadDEx(const pck; const index:integer):integer; stdcall;
    function ReadFEx(const pck; const index:integer):double; stdcall;
    function ReadSEx(const pck; const index:integer):string; stdcall;
    procedure WriteC(var pck: string; const v:byte; ind:integer=-1); stdcall;
    procedure WriteH(var pck: string; const v:word; ind:integer=-1); stdcall;
    procedure WriteD(var pck: string; const v:integer; ind:integer=-1); stdcall;
    procedure WriteF(var pck: string; const v:double; ind:integer=-1); stdcall;
    procedure WriteS(var pck: string; const v:string; ind:integer=-1); stdcall;
    procedure WriteCEx(var pck; const v:byte; ind:integer=-1); stdcall;
    procedure WriteHEx(var pck; const v:word; ind:integer=-1); stdcall;
    procedure WriteDEx(var pck; const v:integer; ind:integer=-1); stdcall;
    procedure WriteFEx(var pck; const v:double; ind:integer=-1); stdcall;
    procedure WriteSEx(var pck; const v:string; ind:integer=-1); stdcall;

    function HexToString(Hex:String):String;
    function StringToHex(str1,Separator:String):String;

    а так же в качестве демо-плагина теперь простенький автоюзатель НР бутылок

Ревизия: 38
Автор: xkor
Дата: 1:55:00, 6 октября 2008 г.
[+] Такс, на SVN сделал ревизию 38, добавлена поддержка плагинов.
    НО!, пока поддержка плагинов не полностью стабильна, глючит если
    включать плагины до захода в игру, но если после захода, то вроде
    всё пашет как надо.
    Да и пока OnConnect и OnDisconnect из плагина не вызываются...

    Вобщем смотрим и думаем что ещё добавить ибо счас плагин писать
    не очень удобно, мало встроенных возможностей.
    ЗЫ исходники простейшего плагина так же на SVN...

Ревизия: 37
Автор: wanick
Дата: 22:14:01, 4 октября 2008 г.
Сообщение:
[-] доработал проверку, перед выгрузкой библиотеки

Ревизия: 36
Автор: wanick
Дата: 3:35:46, 2 октября 2008 г.
Сообщение:
[-] исправления по выгрузки dll

Ревизия: 35
Автор: wanick
Дата: 17:29:17, 1 октября 2008 г.
Сообщение:
[-] выгрузка библиотеки

Ревизия: 33
Автор: wanick
Дата: 21:43:19, 30 сентября 2008 г.
Сообщение:
[+] динамическая выгрузка библиотек inject.dll и newxor.dll p.s. надо доделать отрубания процессов и нитей при выгрузке dll

Ревизия: 32
Автор: wanick
Дата: 18:30:12, 30 сентября 2008 г.
Сообщение:
[+] добавил FastMM_FullDebugMode.dll в сборку чтобы при компиляции не ругалось

Ревизия: 31
Автор: nlobp
Дата: 18:00:07, 30 сентября 2008 г.
Сообщение:
[*] Правил работу потоков (надо тестить)

Ревизия: 29
Автор: wanick
Дата: 2:16:35, 30 сентября 2008 г.
[-] опять глюки в работе кнопок;
[-] поправил replace на текущей позицие работает корректно;

Ревизия: 28
Автор: nlobp
Дата: 0:34:38, 30 сентября 2008 г.
[+] l2phx.log пишем в папку логов;
[+] возможность произвольных имен файлов для newxor и inject, грузим из options.ini;
[+] вывод сообщения о загрузке библиотек с сохранением в логе;
[!] ps: забыл к 26 ревизии добавить пояснения;

Ревизия: 24
Автор: wanick
Дата: 2:03:10, 29 сентября 2008 г.
[-] Исправил поиск процесса;
[+] нужные процессы можно писать через "," и использовать пробелы между процессами (всегда путалсО :D);

Ревизия: 23
Автор: nlobp
Дата: 4:52:32, 28 сентября 2008 г.
[+] добавил два скрипта показывающих работу функции CallSF;
[+] вернул часть критических секций для переменных Thread[i].*;
[+] сменил имя на форме;

Ревизия: 22
Автор: wanick
Дата: 3:38:56, 28 сентября 2008 г.
[-] исправление работы кнопок в закладке скрипты;
[-] Некоторые кнопки переименованы в имена несущие их функционал;

Ревизия: 20
Автор: nlobp
Дата: 1:12:56, 28 сентября 2008 г.
[!] SVN версия;
[!] Тестовая версия!
[+] сохраняем лог в файл;
[+] можно раздвинуть лог вниз;
[+] переделал освобождение хэндлов потоков, спс. Argot;
[-] убрал критические секции (для теста);
[!] завершает работу с ошибкой, где-то я по два раза освобождаю ресурсы без проверки;

Ревизия: 19
Автор: wanick
Дата: 0:33:19, 28 сентября 2008 г.
[+] При создании нового скрипта не проверялось наличие такого же

-SVN-------------------------------------------------------------------------------------
3.3.9 от 23.09.2008
by wanick
[+] теперь включенный скрипт нельзя удалить;
[+] при удалении скрипта не вызывается процедура RefreshScripts (она полностью
    обновляет список скриптов при этом скидывает "галочки" остальных);
[+] процедура sendMSG(msg), для вывода сообщений в окно лога;
[+] новая функция CallSF, которая дает возможность взаимодействия между скриптами;

by NLObP
[+] заменил сообщения для вывода в окно лога на константы, спс. Argot;
[+] освобождаются хэндлы завершившихся потоков, спс. Argot;
[+] устранил несоответствие во всплывающих подсказках (Completion.Identifiers.Strings)
    для вкладки "дополнительно" и "скрипты", спс wanick;
[+] устранил мелкие ошибки в коде;

3.3.8 от 16.09.2008
[+] устранил утечки памяти, спс. Argot;

3.3.7 от 12.09.2008
[+] немного ускорил загрузку лога из файла;
[+] сохраняем выбранный метод внедрения;
[+] на вкладке "просмотр" в списке паrетов, можно поставить первым столбцом номер пакета;
[+] сделал раскраску расшифровки пакета на вкладке "посылка", при дабл-клике в поле
    разбора выделяется кусок пакета соответствующий этой строке;

3.3.6 от 05.09.2008
[-] вернул newxor.dpr как в версии 3.2.0;
[+] заменен TTRrayIcon на TJvTrayIcon;

3.3.5 от 02.09.2008
[+] дополнил имя лога временем записи;
[+] добавил проверку на отсутствие папки logs;
[+] добавил проверку на превышение в папке scripts более 64 скриптов;

3.3.4 от 30.08.2008
[+] при дабл-клике в поле разбора выделяется кусок пакета соответствующий этой строке
[+] исправил работу 'заменить все' (съедался конец строки);
[+] дополнил, если включено запоминать пакеты, то при отключении от сервера пишем лог
    пакетов в папку 'logs\'+Thread[ID].Name+'_'+datetostr(now)+'.txt');

3.3.3 от 29.08.2008
[+] в редакторе скриптов горячие клавиши:
    ctrl-S - сохранение,
    ctrl-F - поиск,
    ctrl-R - поиск с заменой,
    ctrl+F9 проверка скрипта;
[!] после поиска с заменой undo невозможна;
[+] если запоминать пакеты включено, то при отключении от сервера пишем лог
    пакетов в папку .\logs\имя_соединения.txt;

3.3.2 от 23.08.2008
[+] исправил - В скрипте убиваю пакет от сервера, но он всё равно приходит клиенту;

3.3.1 от 22.08.2008
[+] в расшифровке пакетов смещение значений теперь в HEX для выравнивания;
[+] рефакторинг вызова скриптов;
[+] заменил по возможности чекбоксы на глобальные переменные;

3.3.0 от 19.08.2008
[!] отдельная ветка с правкой потоков;
[+] заменил все непосредственные обращения к формам на SendMessage;
[+] все обращения к общим переменным в критических секциях;
[+] сохраняем выбранный протокол:
[+] берем имя соединения из пакетов CharSelected, теперь при рестарте и выборе нового
    чара, имя соединения корректно меняется;
[+] Стало показывать имя соединения на Камаеле, раньше не показывало из-за того,
    что имя бралось из UserInfo, а он в камаеле имеет другой Id.
[+] закрываем отработанные потоки;
[+] небольшая правка ошибок кода;

3.2.15 от 17.08.2008
[+] в расшифровке пакетов добавил вывод смещения значений;
[+] поправил: левое поле хекс преобразований немного съехало влево, и часть текста
    в нем не видно), спс. Emocean;
[+] исправил, отменив перенос строк - в правом нижнем окне бывает сбивка раскраски
    из-за переноса строк.

3.2.14 от 14.08.2008
[!] разбираюсь с потоками;
[+] исправил скрытие пакетов заданного типа из лога пакетов

3.2.13 от 13.08.2008
[+] сделал раскраску расшифровки пакетов. В правом нижнем окне бывает сбивка раскраски
    из-за переноса строк. Надо просто раздвинуть окно и снова щёлкнуть по выбранному пакету;
[+] добавил в newxor.dpr - CryptoInit: Boolean; //Добавил новый флаг by PanAm

3.2.12 от 09.08.2008
[+] в поиске назначил кнопки по умолчанию enter/esc;

3.2.11 от 09.08.2008
[+] сохранение фильтра пакетов в файл, только из packets??.ini, неизвестные пакеты
    не сохраняются в фильтре;
[+] очищаем список пакетов и их расшифровку при отключении сервера/клиента, если
    только не noFreeOnClientDisconnect/noFreeOnServerDisconnect;
[+] при удалении скрипта на вкладке "Скрипты", очищается окно от текста самого скрипта;

3.2.10 от 08.08.2008
[!] убрал по ProtoсolVersion грузим разные packets.ini (C4, С5, T0, T1)
    (ответственность теперь лежит на пользователе);
[+] тул-кнопки вместо чекбоксов на панели Просмотр;
[+] добавил тул-кнопки - "перечитать все инишки" и выбора инишек С4(по умолчанию)/С5/Т0/Т1;
[+] вывод значений в просмотре пакетов, кроме float и quad, в HEX виде - (0x00000436);
[+] добавил отлов ошибки выхода за границу разбираемого пакета, например в UserInfo
    цикл cubics при неверно выбранном протоколе игры;

3.2.9 от 07.08.2008
[+] в редакторе скриптов горячие клавиши: ctrl-F поиск;

3.2.8 от 06.08.2008
[-] исправил замеченные ошибки;
[!] модифицированная инишка для Т1 by YuLaw
[+] дополнил парсер для packetst1.ini - Камаель;
//  Автор: YuLaw
//  здесь в куске d(ListSize:Loop.0003.00065)
//  ListSize - количество повторов цикла
//  Loop - означает что будет цикл
//  0003 - элемент пакета с которого начинать цикл
//  00065 - сколько элементов циклить

3.2.7 от 04.08.2008
[+] пропустил сначала, а теперь добавил загрузку packetsС5.ini (C5);

3.2.6 от 04.08.2008
[!] модифицированные инишки by Sauron
[+] по ProtoсolVersion грузим разные packets.ini (C4, T0, T1)
    (при загрузке из файла первый пакет должен быть всегда ProtoсolVersion,
    иначе сбой определения протокола);

3.2.5 от 04.08.2008
[+] сохраняет размеры окна в конфиге
[+] парсер пакетов использует циклы и функции в packets.ini by Sauron
[+] kID=1000000 в конфиге для Get.NpcID - возвращает текст по его ID из значения аргумента
[+] Get.ClassID - профа
[+] Get.FSup - Status Update ID

3.2.4 от 02.08.2008
[+] парсер пакетов использует циклы и функции в packets.ini by Sauron
    Get.Skill - возвращает название скила по его ID из значения аргумента
    Get.MsgID - возвращает текст по его ID из значения аргумента
    Get.Func01 - возвращает название Item'а по его ID из значения аргумента
    Get.Func02 - возвращает тип Say2
    Get.Func09 - разное

3.2.3 от 01.08.2008
[+] при запуске программы загрузка packets.ini или packetst1.ini в зависимости от галочки Камаель;
[+] при установки/снятии галочки Камаель перечитываем packets.ini или packetst1.ini;
[+] парсер понимает одно и двухбайтные коды пакетов;
[+] в редакторе скриптов горячие клавиши: ctrl-S сохранение, ctrl-F9 проверка скрипта;
[!] иконки сервера и клиента by KyberPrizrak;

3.2.1
[+] поддержка ДЛЛ by QaK
[*] небольшая оптимизации кода by OllyDebug;


CODERX.RU TEAM
~~~~~~~~~~~~~~
В написании кода принимали участие:
Xkor;
NLObP;
Wanick;
QaK.
